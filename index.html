<!--index.html - LCP 및 성능 최적화-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Tech Shop</title>

    <!-- 메타 태그 -->
    <meta name="description" content="VR Headsets - Discover our line of premium VR headsets">

    <!-- 중요 CSS만 인라인으로 포함 -->
    <style>
        /* 중요 렌더링을 위한 최소 CSS */
        body {margin: 0; font-family: sans-serif; padding-top: 80px;}
        .container {width: 1440px; max-width: 90%; margin: auto; padding: 0 16px;}
        header {background-color: #FFF; box-shadow: 0 1px 6px 0 rgba(0,0,0,0.15); height: 80px; position: fixed; top: 0; left: 0; width: 100%; z-index: 1;}
        header .container {display: flex; align-items: center; justify-content: space-between; height: 100%;}
        section.hero {position: relative; overflow: hidden;}
        section.hero img {width: 100%; height: auto; filter: brightness(50%);}
        section.country-bar.hidden {display: none;}
        .progressive-image {opacity: 1; transition: opacity 0.3s ease;}
    </style>

    <!-- 서버 연결 최적화 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fakestoreapi.com">

    <!-- 히어로 이미지 최적화된 로딩 -->
    <link rel="preload" as="image" href="images/Hero_Desktop.webp" media="(min-width: 961px)" fetchpriority="high">
    <link rel="preload" as="image" href="images/Hero_Tablet.webp" media="(min-width: 577px) and (max-width: 960px)" fetchpriority="high">
    <link rel="preload" as="image" href="images/Hero_Mobile.webp" media="(max-width: 576px)" fetchpriority="high">

    <!-- 비동기 폰트 로딩 -->
    <link href="https://fonts.googleapis.com/css?family=Heebo:300,400,600,700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript>
        <link href="https://fonts.googleapis.com/css?family=Heebo:300,400,600,700&display=swap" rel="stylesheet">
    </noscript>

    <!-- 비동기 CSS 로딩 -->
    <link rel="stylesheet" href="/css/styles.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="/css/styles.css">
    </noscript>

    <!-- 지연 로드 스크립트 -->
    <script type="module" src="./js/main.js" defer></script>

    <!-- Preload 중요 스크립트 -->
    <link rel="modulepreload" href="./js/products.js">

    <!-- 쿠키 동의 스크립트 - 지연 로드 -->
    <script>
      // 스크롤 후 쿠키 스크립트 로드
      let cookieLoaded = false;
      function loadCookieConsent() {
        if (cookieLoaded) return;
        cookieLoaded = true;

        const script = document.createElement('script');
        script.src = "//www.freeprivacypolicy.com/public/cookie-consent/4.1.0/cookie-consent.js";
        script.charset = "UTF-8";
        script.onload = function() {
          if (typeof cookieconsent !== 'undefined') {
            cookieconsent.run({"notice_banner_type":"simple","consent_type":"express","palette":"light","language":"en","page_load_consent_levels":["strictly-necessary"],"notice_banner_reject_button_hide":false,"preferences_center_close_button_hide":false,"page_refresh_confirmation_buttons":false,"website_name":"Performance Course"});
          }
        };
        document.head.appendChild(script);
      }

      // 지연 로드
      window.addEventListener('load', function() {
        setTimeout(function() {
          loadCookieConsent();
        }, 3000);
      });
    </script>

    <!-- Google Tag Manager - 사용자 상호작용 후 로드 -->
    <script>
      // 사용자 상호작용 후 GTM 로드
      let gtmLoaded = false;
      function loadGTM() {
        if (gtmLoaded) return;
        gtmLoaded = true;

        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PKK35GL5');
      }

      // 사용자 상호작용시 로드
      ['click', 'scroll', 'keydown'].forEach(event => {
        window.addEventListener(event, function() {
          loadGTM();
        }, {once: true});
      });
    </script>
</head>

<body>
<!-- GTM noscript 지연 로드 -->
<noscript id="gtm-noscript"></noscript>

<header>
    <div class="container">
        <section class="logo">
            <a href="index.html">
                <strong>VR</strong>
                <span class="blue-dot"></span>
                <span class="blue-dot"></span>
                <span>Headsets</span>
            </a>
        </section>
        <nav>
            <ul>
                <li><a href="about.html">About us</a></li>
                <li><a href="index.html#best-sellers-section">Best Sellers</a></li>
                <li><a href="index.html#newsletter-section">Newsletter</a></li>
                <li class="menu-icon"><img src="images/menu_icon.webp" alt="Menu icon" width="24" height="24" loading="lazy"></li>
            </ul>
        </nav>
    </div>
</header>

<section class="hero">
    <!-- 최적화된 히어로 이미지 로딩 -->
    <picture>
        <!-- 데스크톱 -->
        <source srcset="images/Hero_Desktop.webp" media="(min-width: 961px)" type="image/webp">
        <source srcset="images/Hero_Desktop.jpg" media="(min-width: 961px)" type="image/jpeg">

        <!-- 태블릿 -->
        <source srcset="images/Hero_Tablet.webp" media="(min-width: 577px) and (max-width: 960px)" type="image/webp">
        <source srcset="images/Hero_Tablet.jpg" media="(min-width: 577px) and (max-width: 960px)" type="image/jpeg">

        <!-- 모바일 -->
        <source srcset="images/Hero_Mobile.webp" media="(max-width: 576px)" type="image/webp">
        <source srcset="images/Hero_Mobile.jpg" media="(max-width: 576px)" type="image/jpeg">

        <!-- 메인 이미지 - width/height 속성으로 레이아웃 시프트 방지 -->
        <img class="desktop hero-image"
             src="images/Hero_Desktop.webp"
             alt="VR Headsets"
             width="1440" height="660"
             fetchpriority="high">
    </picture>

    <div class="hero-content">
        <div class="container">
            <h1>Discover our line of VR Headsets</h1>
            <p>
                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium
                doloremque laudantium.
            </p>
            <button>View Headsets</button>
        </div>
    </div>
</section>

<section class="country-bar hidden">
    <!-- 동적으로 추가되는 국가 정보 -->
</section>

<!-- Best Sellers 섹션 -->
<section class="best-sellers" id="best-sellers-section">
    <h1>Best Sellers</h1>
    <hr>
    <div class="product-slider">
        <div class="container">
            <div class="product new">
                <div class="product-picture">
                    <!-- 최적화된 이미지 로딩 -->
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 250 250' fill='%23f0f0f0'%3E%3Crect width='250' height='250' /%3E%3C/svg%3E"
                         data-src="images/vr1.webp"
                         alt="product: Apple Headset"
                         width="250" height="250"
                         loading="lazy"
                         class="progressive-image blur">
                </div>
                <div class="product-info">
                    <h5 class="categories">Headsets, Apple</h5>
                    <h4 class="title">Apple Headset</h4>
                    <h3 class="price">
                        <span>US$ 450.00</span>
                    </h3>
                    <button>ADD TO BAG</button>
                </div>
            </div>

            <div class="product new">
                <div class="product-picture">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 250 250' fill='%23f0f0f0'%3E%3Crect width='250' height='250' /%3E%3C/svg%3E"
                         data-src="images/vr2.webp"
                         alt="product: Playstation Headset"
                         width="250" height="250"
                         loading="lazy"
                         class="progressive-image blur">
                </div>
                <div class="product-info">
                    <h5 class="categories">Headsets, PS</h5>
                    <h4 class="title">Playstation Headset</h4>
                    <h3 class="price">
                        <span>US$ 399.99</span>
                    </h3>
                    <button>ADD TO BAG</button>
                </div>
            </div>

            <div class="product">
                <div class="product-picture">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 250 250' fill='%23f0f0f0'%3E%3Crect width='250' height='250' /%3E%3C/svg%3E"
                         data-src="images/vr3.webp"
                         alt="product: Oculus Headset"
                         width="250" height="250"
                         loading="lazy"
                         class="progressive-image blur">
                </div>
                <div class="product-info">
                    <h5 class="categories">Headsets, Oculus</h5>
                    <h4 class="title">Oculus Headset</h4>
                    <h3 class="price">
                        <span class="discounted-price">US$ 349.99</span>
                        <span class="original-price">US$ 419.99</span>
                    </h3>
                    <button>ADD TO BAG</button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- All Products 섹션 -->
<section class="best-sellers">
    <h1>All Products</h1>
    <hr>
    <div class="product-slider" id="all-products" data-lazy-action="load-products">
        <div class="container">
            <!-- 로딩 플레이스홀더 -->
            <div class="product-chunk-placeholder">
                <!-- 로딩 중 표시 -->
            </div>
        </div>
    </div>
</section>

<section class="newsletter" id="newsletter-section">
    <h3>Newsletter Signup</h3>
    <p>Subscribe now and don't miss a single deal!</p>
    <form>
        <input type="email" name="email" placeholder="Your email...">
        <button type="submit">Subscribe</button>
    </form>
</section>

<footer>
    <div class="bottom-nav">
        <div class="container">
            <ul>
                <li class="list-title">Categories</li>
                <li><a href="#">Watches</a></li>
                <li><a href="#">Cameras</a></li>
                <li><a href="#">Phones</a></li>
                <li><a href="#">Tablets</a></li>
                <li><a href="#">Computers</a></li>
            </ul>

            <ul>
                <li class="list-title">About Us</li>
                <li><a href="#">Our Story</a></li>
                <li><a href="#">Press</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Awards</a></li>
                <li><a href="#">Stores</a></li>
            </ul>

            <ul>
                <li class="list-title">Social Media</li>
                <li><a href="#">Facebook</a></li>
                <li><a href="#">Linkedin</a></li>
                <li><a href="#">Instagram</a></li>
                <li><a href="#">Twitter</a></li>
                <li><a href="#">Youtube</a></li>
            </ul>

            <ul>
                <li class="list-title">Customer Service</li>
                <li><a href="#">Live Chat</a></li>
                <li><a href="#">Contact Us</a></li>
                <li><a href="#">Terms & Conditions</a></li>
                <li><a href="#">Delivery & Returns</a></li>
                <li><a href="#">Finance</a></li>
            </ul>
        </div>
    </div>
    <div class="copyright-text">
        2020 &copy; All Rights Reserved
    </div>
</footer>

<a href="#" id="open_preferences_center">Update cookies preferences</a>

<!-- 이미지 로딩 스크립트 -->
<script>
  // 프로그레시브 이미지 로딩
  document.addEventListener('DOMContentLoaded', function() {
    // 이미지 관찰자 초기화
    const imgObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          const img = entry.target;
          const src = img.dataset.src;

          if (src) {
            img.src = src;
            img.classList.remove('blur');
            observer.unobserve(img);
          }
        }
      });
    }, {
      rootMargin: '0px 0px 200px 0px',
      threshold: 0.01
    });

    // 모든 지연 로딩 이미지에 관찰자 적용
    document.querySelectorAll('.progressive-image').forEach(function(img) {
      imgObserver.observe(img);
    });
  });
</script>
</body>
</html>